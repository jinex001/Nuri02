<!DOCTYPE html>

<html lang="ko" style="color-scheme:light;">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="color-scheme" content="light">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="apple-mobile-web-app-title" content="Nuri">
<link rel="manifest" href="/manifest.json">
<title>Nuri</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500&family=Outfit:wght@300;400;500;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://unpkg.com/@phosphor-icons/web@2.1.1/src/regular/style.css">
<style>
  :root {
    color-scheme: light;
    --lilac: #C8A2C9;
    --lilac-deep: #8B5E8C;
    --lilac-pale: #F0E6F1;
    --cream: #FEFBCE;
    --cream-muted: #FAF6B8;
    --surface: #FFFFFF;
    --surface2: #FAF7FB;
    --text: #1E1520;
    --text-mid: #5C4D5E;
    --text-soft: #9B8A9D;
    --border: #D4B0D5;
    --gold: #C9A96E;
    --green: #7EC8A4;
    --green-pale: #E8F7F0;
    --green-text: #4A9070;
  }
  *, *::before, *::after { margin:0; padding:0; box-sizing:border-box; -webkit-tap-highlight-color:transparent; }
  html, body { width:100%; height:100%; overflow:hidden; font-family:'Outfit',sans-serif; background:#2A1F2E; color:var(--text); -webkit-font-smoothing:antialiased; }
  #app { width:100%; height:100%; max-width:430px; margin:0 auto; background:#FFFFFF; position:relative; overflow:hidden; }

/* SCREENS */
.screen { position:absolute; inset:0; overflow-y:auto; overflow-x:hidden; -webkit-overflow-scrolling:touch; padding-bottom:82px; background:#FFFFFF; transform:translateX(100%); transition:transform 0.32s cubic-bezier(0.4,0,0.2,1); }
.screen.active { transform:translateX(0); }
.screen.exit { transform:translateX(-28%); }

/* STATUS BAR */
.status-bar { padding:14px 24px 0; display:flex; justify-content:space-between; font-size:12px; font-weight:600; color:#1E1520; }
.status-bar.light { color:rgba(255,255,255,0.8); }

/* BOTTOM NAV */
.bottom-nav { position:fixed; bottom:20px; left:50%; transform:translateX(-50%); width:auto; background:rgba(30,21,32,0.85); backdrop-filter:blur(20px); -webkit-backdrop-filter:blur(20px); border:1px solid rgba(255,255,255,0.1); border-radius:40px; padding:10px 16px; display:flex; align-items:center; gap:4px; z-index:999; box-shadow:0 8px 32px rgba(0,0,0,0.3); }
.nav-item { display:flex; align-items:center; justify-content:center; padding:8px 14px; border-radius:30px; cursor:pointer; }
.nav-item i { font-size:22px; color:rgba(255,255,255,0.5); }
.nav-item.active { background:rgba(200,162,201,0.25); }
.nav-item.active i { color:#E2CCE3; }
.fab { width:40px; height:40px; border-radius:50%; background:linear-gradient(135deg,#8B5E8C,#5A2E5B); display:flex; align-items:center; justify-content:center; color:white; font-size:20px; margin:0 4px; box-shadow:0 4px 14px rgba(139,94,140,0.5); cursor:pointer; }

/* HOME */
.home-header { padding:14px 20px 0; }
.home-top { display:flex; justify-content:space-between; align-items:center; margin-bottom:14px; }
.logo { font-family:â€˜Playfair Displayâ€™,serif; font-size:28px; color:#1E1520; letter-spacing:0.04em; }
.logo em { color:var(â€“lilac-deep); font-style:normal; }
.avatar-btn { width:38px; height:38px; border-radius:50%; background:linear-gradient(135deg,var(â€“lilac),var(â€“lilac-deep)); display:flex; align-items:center; justify-content:center; font-size:17px; box-shadow:0 2px 10px rgba(139,94,140,0.35); cursor:pointer; }
.week-card { border-radius:20px; padding:16px 18px; display:flex; align-items:center; gap:14px; margin-bottom:16px; position:relative; overflow:hidden; background-color:#1E1520; background-image:linear-gradient(135deg,#1E1520 0%,#3A2B3C 100%); }
.week-card::after { content:â€™â€™; position:absolute; right:-15px; top:-15px; width:90px; height:90px; background:radial-gradient(circle,rgba(200,162,201,0.25) 0%,transparent 70%); border-radius:50%; }
.week-num { font-family:â€˜Playfair Displayâ€™,serif; font-size:54px; line-height:1; color:#FFFFFF; flex-shrink:0; }
.week-num sup { font-family:â€˜Outfitâ€™,sans-serif; font-size:14px; font-weight:300; opacity:0.5; vertical-align:super; }
.week-info { flex:1; }
.week-info h3 { font-size:13px; font-weight:500; color:rgba(255,255,255,0.9); margin-bottom:3px; }
.week-info p { font-size:11px; color:rgba(255,255,255,0.5); line-height:1.5; }
.edd-box { background:rgba(254,251,206,0.12); border:1px solid rgba(254,251,206,0.22); border-radius:10px; padding:8px 10px; text-align:center; flex-shrink:0; }
.edd-box .lbl { font-size:9px; color:rgba(255,255,255,0.45); letter-spacing:0.08em; text-transform:uppercase; }
.edd-box .val { font-size:15px; font-weight:600; color:#FEFBCE; margin-top:1px; }

/* CALENDAR */
.cal-wrap { padding:0 20px 14px; }
.cal-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:10px; }
.cal-month { font-family:â€˜Playfair Displayâ€™,serif; font-size:17px; color:#1E1520; }
.cal-nav { display:flex; gap:6px; }
.cal-nav-btn { width:28px; height:28px; border-radius:8px; background:var(â€“lilac-pale); border:none; color:var(â€“lilac-deep); font-size:14px; cursor:pointer; display:flex; align-items:center; justify-content:center; }
.cal-grid { display:grid; grid-template-columns:repeat(7,1fr); gap:2px; }
.cal-wday { text-align:center; font-size:9px; font-weight:700; letter-spacing:0.05em; text-transform:uppercase; color:var(â€“text-soft); padding:4px 0 6px; }
.cal-d { aspect-ratio:1; display:flex; flex-direction:column; align-items:center; justify-content:center; border-radius:9px; font-size:12px; color:#5C4D5E; position:relative; cursor:pointer; }
.cal-d.empty { pointer-events:none; }
.cal-d.today { background-color:#1E1520; color:#FFFFFF; font-weight:700; }
.dot { position:absolute; bottom:3px; width:4px; height:4px; border-radius:50%; }
.dot-diary { background:var(â€“lilac); }
.dot-us { background:var(â€“gold); }
.dot-appt { background:var(â€“green); }
.cal-d.today .dot { background:rgba(255,255,255,0.7); }
.cal-legend { display:flex; gap:12px; margin-top:8px; }
.legend-item { display:flex; align-items:center; gap:5px; font-size:10px; color:var(â€“text-soft); }
.legend-dot { width:6px; height:6px; border-radius:50%; }
.appt-banner { margin-top:12px; background-color:#E8F7F0; border:1px solid rgba(126,200,164,0.25); border-radius:16px; padding:12px 14px; display:flex; align-items:center; gap:12px; cursor:pointer; }
.appt-icon { width:38px; height:38px; border-radius:11px; background:rgba(126,200,164,0.3); display:flex; align-items:center; justify-content:center; font-size:18px; flex-shrink:0; }
.appt-info { flex:1; }
.appt-info .top { font-size:9px; font-weight:700; letter-spacing:0.1em; text-transform:uppercase; color:#4A9070; margin-bottom:2px; }
.appt-info .main { font-size:13px; font-weight:600; color:#1E1520; }
.appt-info .sub { font-size:11px; color:#5A7A6A; margin-top:1px; }
.appt-badge { font-size:11px; font-weight:700; color:#4A9070; background:rgba(126,200,164,0.2); padding:4px 10px; border-radius:20px; flex-shrink:0; }

/* TIMELINE */
.timeline { padding:0 18px 20px; }
.tl-date { font-size:10px; font-weight:700; letter-spacing:0.1em; text-transform:uppercase; color:var(â€“text-soft); margin:16px 0 10px 2px; display:flex; align-items:center; gap:8px; }
.tl-date::after { content:â€™â€™; flex:1; height:1px; background:var(â€“border); }
.tl-row { display:flex; gap:10px; margin-bottom:10px; animation:up 0.35s ease both; }
.tl-spine { display:flex; flex-direction:column; align-items:center; padding-top:13px; flex-shrink:0; width:18px; }
.tl-dot { width:8px; height:8px; border-radius:50%; background:var(â€“lilac); flex-shrink:0; }
.tl-dot.gold { background:var(â€“gold); }
.tl-dot.green { background:var(â€“green); }
.tl-line { flex:1; width:1px; background:var(â€“border); margin-top:3px; min-height:16px; }
.card { flex:1; background:#FAF7FB; border:1px solid var(â€“border); border-radius:16px; overflow:hidden; }
.card.appt-card { background-color:#F4FCF8; border-color:rgba(126,200,164,0.3); }
.card-top { padding:11px 13px 8px; display:flex; align-items:center; gap:9px; }
.card-icon { width:28px; height:28px; border-radius:8px; display:flex; align-items:center; justify-content:center; font-size:13px; flex-shrink:0; }
.card-icon.us { background:linear-gradient(135deg,#111122,#2d2d44); }
.card-icon.diary { background:#FAF6B8; }
.card-icon.appt { background:#E8F7F0; }
.card-meta { flex:1; }
.card-type { font-size:9px; font-weight:700; letter-spacing:0.08em; text-transform:uppercase; color:var(â€“text-soft); }
.card-type.green { color:#4A9070; }
.card-time { font-size:12px; font-weight:500; color:#1E1520; }
.week-tag { font-size:10px; font-weight:700; color:var(â€“lilac-deep); background:var(â€“lilac-pale); padding:2px 8px; border-radius:20px; }
.week-tag.green { color:#4A9070; background:#E8F7F0; }
.us-photo { width:100%; height:125px; background-color:#111122; background-image:linear-gradient(135deg,#111122 0%,#1e1e36 50%,#111122 100%); display:flex; align-items:center; justify-content:center; position:relative; }
.us-photo::before { content:â€™â€™; position:absolute; width:75px; height:58px; border:1.5px solid rgba(180,220,255,0.35); border-radius:50%; box-shadow:0 0 28px rgba(130,180,255,0.2); }
.us-photo-lbl { position:absolute; bottom:7px; left:11px; font-size:9px; color:rgba(255,255,255,0.35); }
.card-body { padding:3px 13px 11px; }
.card-text { font-size:12px; color:#5C4D5E; line-height:1.6; }
.mood { display:inline-flex; align-items:center; gap:4px; background:#FAF6B8; border-radius:20px; padding:3px 9px; font-size:10px; color:#5C4D5E; margin-top:5px; }
.tag-row { display:flex; gap:5px; margin-top:6px; flex-wrap:wrap; }
.tag { background:rgba(126,200,164,0.18); border-radius:7px; padding:3px 9px; font-size:10px; font-weight:600; color:#4A9070; }
.comments { border-top:1px solid var(â€“border); padding:8px 13px 11px; display:flex; flex-direction:column; gap:7px; }
.cmt-row { display:flex; gap:7px; align-items:flex-start; }
.cmt-av { width:22px; height:22px; border-radius:50%; background:var(â€“lilac-pale); display:flex; align-items:center; justify-content:center; font-size:10px; flex-shrink:0; border:1px solid var(â€“border); }
.cmt-bubble { background:white; border:1px solid var(â€“border); border-radius:9px 9px 9px 2px; padding:6px 10px; flex:1; }
.cmt-name { font-size:9px; font-weight:700; color:var(â€“lilac-deep); margin-bottom:1px; }
.cmt-text { font-size:11px; color:#5C4D5E; line-height:1.4; }
.cmt-input-row { display:flex; gap:7px; align-items:center; }
.cmt-input { flex:1; background:white; border:1px solid var(â€“border); border-radius:18px; padding:6px 12px; font-size:11px; color:var(â€“text-soft); font-family:â€˜Outfitâ€™,sans-serif; outline:none; }

/* NEW ENTRY */
.screen-hdr { padding:14px 18px 12px; display:flex; align-items:center; gap:11px; border-bottom:1px solid var(â€“border); background:#FFFFFF; }
.back-btn { width:34px; height:34px; border-radius:10px; background:#FAF7FB; border:1px solid var(â€“border); display:flex; align-items:center; justify-content:center; font-size:16px; color:#5C4D5E; cursor:pointer; }
.screen-hdr-title { font-family:â€˜Playfair Displayâ€™,serif; font-size:20px; color:#1E1520; }
.type-tabs { display:flex; background:#FAF7FB; border:1px solid var(â€“border); border-radius:14px; padding:4px; margin:14px 18px 0; }
.type-tab { flex:1; padding:9px 4px; border-radius:10px; text-align:center; font-size:11px; font-weight:500; color:var(â€“text-soft); cursor:pointer; }
.type-tab.on { background:white; color:#1E1520; box-shadow:0 2px 8px rgba(30,21,32,0.07); }
.form-pad { padding:14px 18px; background:#FFFFFF; }
.cam-zone { border:1.5px dashed rgba(200,162,201,0.5); border-radius:20px; height:168px; display:flex; flex-direction:column; align-items:center; justify-content:center; gap:7px; background:rgba(200,162,201,0.04); cursor:pointer; margin-bottom:18px; overflow:hidden; }
.cam-zone .ic { font-size:30px; opacity:0.65; }
.cam-zone .lbl { font-size:13px; font-weight:500; color:#5C4D5E; }
.cam-zone .sub { font-size:11px; color:var(â€“text-soft); }
.fld { margin-bottom:15px; }
.fld-lbl { font-size:10px; font-weight:700; letter-spacing:0.1em; text-transform:uppercase; color:var(â€“text-soft); display:block; margin-bottom:7px; }
.txt-in { width:100%; background:#FAF7FB; border:1px solid var(â€“border); border-radius:13px; padding:11px 14px; font-size:13px; color:#1E1520; font-family:â€˜Outfitâ€™,sans-serif; outline:none; }
.txt-in:focus { border-color:var(â€“lilac); background:white; box-shadow:0 0 0 3px rgba(200,162,201,0.12); }
.pills { display:flex; gap:7px; flex-wrap:wrap; }
.pill { padding:6px 13px; border-radius:20px; font-size:11px; font-weight:500; background:#FAF7FB; border:1px solid var(â€“border); color:var(â€“text-soft); cursor:pointer; }
.pill.on { background:var(â€“lilac-pale); border-color:var(â€“lilac); color:var(â€“lilac-deep); }
.save-btn { width:100%; background-image:linear-gradient(135deg,#8B5E8C 0%,#5A2E5B 100%); color:white; border:none; border-radius:15px; padding:14px; font-family:â€˜Outfitâ€™,sans-serif; font-size:14px; font-weight:600; cursor:pointer; box-shadow:0 5px 20px rgba(107,61,108,0.3); margin-top:6px; }

/* MEDICAL */
.med-hero { background-color:#1E1520; background-image:linear-gradient(155deg,#1E1520 0%,#3A2B3C 55%,#5A3A5C 100%); padding:52px 22px 26px; position:relative; overflow:hidden; }
.med-hero::before { content:â€™â€™; position:absolute; width:160px; height:160px; background:radial-gradient(circle,rgba(200,162,201,0.18) 0%,transparent 70%); top:-40px; right:-30px; border-radius:50%; }
.med-lbl { font-size:9px; font-weight:700; letter-spacing:0.14em; text-transform:uppercase; color:rgba(255,255,255,0.4); margin-bottom:4px; }
.med-name { font-family:â€˜Playfair Displayâ€™,serif; font-size:26px; color:#FFFFFF; margin-bottom:18px; line-height:1.2; }
.sos-strip { background:rgba(255,255,255,0.08); border:1px solid rgba(255,255,255,0.14); border-radius:15px; padding:11px 14px; display:flex; align-items:center; gap:11px; }
.sos-icon { width:34px; height:34px; border-radius:9px; background:rgba(220,50,50,0.25); border:1px solid rgba(220,50,50,0.35); display:flex; align-items:center; justify-content:center; font-size:15px; flex-shrink:0; }
.sos-txt { font-size:11px; color:rgba(255,255,255,0.65); line-height:1.5; }
.sos-txt strong { color:white; font-weight:500; display:block; margin-bottom:1px; font-size:12px; }
.sos-arrow { margin-left:auto; color:rgba(255,255,255,0.25); font-size:16px; }
.med-body { padding:14px 16px 20px; background:#FFFFFF; }
.info-block { background:#FAF7FB; border:1px solid var(â€“border); border-radius:18px; overflow:hidden; margin-bottom:11px; }
.info-block.appt-block { border-color:rgba(126,200,164,0.3); }
.block-title { padding:11px 16px 8px; font-size:10px; font-weight:700; letter-spacing:0.1em; text-transform:uppercase; color:var(â€“text-soft); border-bottom:1px solid var(â€“border); background:#FAF7FB; }
.block-title.green { color:#4A9070; }
.info-row { display:flex; justify-content:space-between; align-items:center; padding:10px 16px; border-bottom:1px solid var(â€“border); background:#FAF7FB; }
.info-row:last-child { border-bottom:none; }
.i-lbl { font-size:12px; color:var(â€“text-soft); }
.i-val { font-size:13px; font-weight:500; color:#1E1520; text-align:right; }
.chip-blood { background-image:linear-gradient(135deg,#8B5E8C,#6B3D6C); color:white; padding:4px 11px; border-radius:8px; font-size:14px; font-weight:700; }
.chip-ok { background:#E6F4EA; color:#2D7A3A; border-radius:8px; padding:4px 10px; font-size:11px; font-weight:600; }
.chip-warn { background:#FFF3E0; color:#C35A00; border-radius:8px; padding:4px 10px; font-size:11px; font-weight:600; }
.appt-row-inner { flex:1; }
.appt-row-inner .albl { font-size:11px; color:var(â€“text-soft); margin-bottom:2px; }
.appt-row-inner .atitle { font-size:13px; font-weight:600; color:#1E1520; }
.appt-row-inner .asub { font-size:11px; color:#5A7A6A; margin-top:1px; }
.d-badge { font-size:11px; font-weight:700; padding:4px 10px; border-radius:18px; flex-shrink:0; margin-left:10px; }
.d-badge.soon { color:#4A9070; background:#E8F7F0; }
.d-badge.later { color:var(â€“text-soft); background:#FAF7FB; border:1px solid var(â€“border); }

@keyframes up { from{opacity:0;transform:translateY(10px)} to{opacity:1;transform:translateY(0)} }
</style>

</head>
<body>
<div id="app">

  <!-- LOGIN -->

  <div class="screen" id="s-login">
    <div style="height:100%;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px 32px;background:#FFFFFF;">
      <div style="font-family:'Playfair Display',serif;font-size:48px;color:#1E1520;margin-bottom:8px;">nuri</div>
      <div style="font-size:13px;color:#9B8A9D;margin-bottom:48px;">ì„ì‹  ê¸°ë¡ì„ ì‹œì‘í•´ìš” ğŸŒ¸</div>
      <div style="width:100%;display:flex;flex-direction:column;gap:12px;">
        <input id="login-email" class="txt-in" type="email" placeholder="ì´ë©”ì¼">
        <input id="login-pw" class="txt-in" type="password" placeholder="ë¹„ë°€ë²ˆí˜¸">
        <button class="save-btn" onclick="signIn()">ë¡œê·¸ì¸</button>
        <button onclick="signUp()" style="width:100%;background:var(--lilac-pale);color:var(--lilac-deep);border:none;border-radius:15px;padding:14px;font-family:'Outfit',sans-serif;font-size:14px;font-weight:600;cursor:pointer;">íšŒì›ê°€ì…</button>
      </div>
    </div>
  </div>

  <!-- HOME -->

  <div class="screen" id="s-home">
    
    <div class="home-header">
      <div class="home-top">
        <div class="logo">nu<em>ri</em></div>
        <div class="avatar-btn" onclick="goTo('s-medical')">ğŸŒ¸</div>
      </div>
      <div class="week-card">
        <div class="week-num">24<sup>w</sup></div>
        <div class="week-info">
          <h3>ì„ì‹  24ì£¼ Â· 6ê°œì›”</h3>
          <p>ì•„ê¸°ëŠ” ì˜¥ìˆ˜ìˆ˜ í¬ê¸° ğŸŒ½<br>ì²­ê°ì´ ë°œë‹¬ ì¤‘ì´ì—ìš”</p>
        </div>
        <div class="edd-box"><div class="lbl">ì˜ˆì •ì¼</div><div class="val">6.15</div></div>
      </div>
    </div>
    <div class="cal-wrap">
      <div class="cal-header">
        <div class="cal-month">February 2024</div>
        <div class="cal-nav"><button class="cal-nav-btn">â€¹</button><button class="cal-nav-btn">â€º</button></div>
      </div>
      <div class="cal-grid">
        <div class="cal-wday">S</div><div class="cal-wday">M</div><div class="cal-wday">T</div><div class="cal-wday">W</div><div class="cal-wday">T</div><div class="cal-wday">F</div><div class="cal-wday">S</div>
        <div class="cal-d empty"></div><div class="cal-d empty"></div><div class="cal-d empty"></div>
        <div class="cal-d">1</div><div class="cal-d">2</div><div class="cal-d">3<span class="dot dot-diary"></span></div><div class="cal-d">4</div>
        <div class="cal-d">5</div><div class="cal-d">6</div><div class="cal-d">7<span class="dot dot-diary"></span></div><div class="cal-d">8</div><div class="cal-d">9</div><div class="cal-d">10<span class="dot dot-us"></span></div><div class="cal-d">11</div>
        <div class="cal-d">12<span class="dot dot-us"></span></div><div class="cal-d">13</div><div class="cal-d">14<span class="dot dot-diary"></span></div><div class="cal-d">15</div><div class="cal-d">16</div><div class="cal-d">17</div><div class="cal-d">18</div>
        <div class="cal-d">19</div><div class="cal-d today">20<span class="dot"></span></div><div class="cal-d">21</div><div class="cal-d">22</div><div class="cal-d">23<span class="dot dot-appt"></span></div><div class="cal-d">24</div><div class="cal-d">25</div>
        <div class="cal-d">26</div><div class="cal-d">27</div><div class="cal-d">28</div><div class="cal-d">29</div>
      </div>
      <div class="cal-legend">
        <div class="legend-item"><div class="legend-dot" style="background:var(--lilac)"></div>ì¼ê¸°</div>
        <div class="legend-item"><div class="legend-dot" style="background:var(--gold)"></div>ì´ˆìŒíŒŒ</div>
        <div class="legend-item"><div class="legend-dot" style="background:var(--green)"></div>ì§„ë£Œ</div>
      </div>
      <div class="appt-banner" onclick="goTo('s-medical')">
        <div class="appt-icon">ğŸ¥</div>
        <div class="appt-info">
          <div class="top">ë‹¤ìŒ ì§„ë£Œ</div>
          <div class="main">2ì›” 23ì¼ (í† ) ì˜¤ì „ 10:30</div>
          <div class="sub">ì„œìš¸ ì„±ëª¨ ë³‘ì› Â· Dr. ë°•ë¯¸ì—°</div>
        </div>
        <div class="appt-badge">3ì¼ í›„</div>
      </div>
    </div>
    <div class="timeline"></div>
  </div>

  <!-- NEW ENTRY -->

  <div class="screen" id="s-new">
    
    <div class="screen-hdr">
      <div class="back-btn" onclick="goBack()">â†</div>
      <div class="screen-hdr-title">ìƒˆë¡œìš´ ê¸°ë¡</div>
    </div>
    <div class="type-tabs">
      <div class="type-tab on" onclick="selTab(this)">ğŸ“· ì´ˆìŒíŒŒ</div>
      <div class="type-tab" onclick="selTab(this)">ğŸ“ ì¼ê¸°</div>
      <div class="type-tab" onclick="selTab(this)">ğŸ¥ ì§„ë£Œ</div>
    </div>
    <div class="form-pad">
      <div class="cam-zone" onclick="document.getElementById('photo-input').click()">
        <div class="ic">ğŸ“·</div>
        <div class="lbl" id="cam-lbl">ì´ˆìŒíŒŒ ì‚¬ì§„ ì´¬ì˜</div>
        <div class="sub">ì‚¬ì§„ ì˜ì—­ì´ ìë™ ì¸ì‹ë¼ìš”</div>
        <img id="photo-preview" style="display:none;width:100%;height:100%;object-fit:cover;border-radius:18px;">
      </div>
      <input type="file" id="photo-input" accept="image/*" capture="environment" style="display:none" onchange="previewPhoto(this)">
      <div class="fld">
        <label class="fld-lbl">ì„ì‹  ì£¼ìˆ˜</label>
        <div class="pills" id="week-pills">
          <div class="pill" onclick="selPill(this)">22ì£¼</div>
          <div class="pill" onclick="selPill(this)">23ì£¼</div>
          <div class="pill on" onclick="selPill(this)">24ì£¼</div>
          <div class="pill" onclick="selPill(this)">25ì£¼</div>
          <div class="pill" onclick="selPill(this)">26ì£¼</div>
        </div>
      </div>
      <div class="fld">
        <label class="fld-lbl">ë©”ëª¨</label>
        <input id="entry-content" class="txt-in" placeholder="ì˜¤ëŠ˜ ê¸°ë¡...">
      </div>
      <div class="fld">
        <label class="fld-lbl">ê°ì •</label>
        <div class="pills" id="mood-pills">
          <div class="pill" onclick="selPill(this)">ğŸ˜Š í–‰ë³µ</div>
          <div class="pill on" onclick="selPill(this)">ğŸ¥¹ ê°ë™</div>
          <div class="pill" onclick="selPill(this)">ğŸ˜° ê±±ì •</div>
          <div class="pill" onclick="selPill(this)">ğŸ˜´ í”¼ê³¤</div>
        </div>
      </div>
      <div class="fld">
        <label class="fld-lbl">ê³µê°œ ë²”ìœ„</label>
        <div class="pills" id="privacy-pills">
          <div class="pill on" onclick="selPill(this)" id="privacy-private">ğŸ”’ ë‚˜ë§Œ ë³´ê¸°</div>
          <div class="pill" onclick="selPill(this)" id="privacy-public">ğŸ’œ íŒŒíŠ¸ë„ˆ ê³µê°œ</div>
        </div>
      </div>
      <button class="save-btn" onclick="saveEntry()">ì €ì¥í•˜ê¸°</button>
    </div>
  </div>

  <!-- MEDICAL -->

  <div class="screen" id="s-medical">
    <div class="status-bar light" style="position:absolute;top:0;left:0;right:0;z-index:2;background:transparent">
      <span>9:41</span><span>â—â—â— ğŸ”‹</span>
    </div>
    <div class="med-hero">
      <div class="med-lbl">ë©”ë””ì»¬ í”„ë¡œí•„</div>
      <div class="med-name">ê±´ê°• ê¸°ë¡</div>
      <div class="sos-strip">
        <div class="sos-icon">ğŸ†˜</div>
        <div class="sos-txt"><strong>ì ê¸ˆí™”ë©´ ì‘ê¸‰ ì •ë³´ ì—°ë™</strong>iPhone Health ì•±ì—ì„œ ì¦‰ì‹œ í™•ì¸ ê°€ëŠ¥</div>
        <div class="sos-arrow">â€º</div>
      </div>
    </div>
    <div class="med-body">
      <div class="info-block">
        <div class="block-title">ì˜ë£Œ ì •ë³´</div>
        <div class="info-row"><div class="i-lbl">í˜ˆì•¡í˜•</div><div class="chip-blood">A+</div></div>
        <div class="info-row"><div class="i-lbl">ì„ì‹  ìƒíƒœ</div><div class="chip-ok">âœ“ ì •ìƒ ì„ì‹ </div></div>
        <div class="info-row"><div class="i-lbl">ì•Œë ˆë¥´ê¸°</div><div class="chip-warn">âš  í˜ë‹ˆì‹¤ë¦°</div></div>
      </div>
    </div>
  </div>

  <!-- PARTNER FEED -->

  <div class="screen" id="s-partner">
    
    <div style="padding:20px 20px 0;">
      <div style="display:flex;align-items:center;gap:12px;margin-bottom:16px;">
        <div style="width:48px;height:48px;border-radius:50%;background:linear-gradient(135deg,var(--lilac),var(--lilac-deep));display:flex;align-items:center;justify-content:center;font-size:22px;">ğŸŒ¸</div>
        <div>
          <div id="partner-name" style="font-family:'Playfair Display',serif;font-size:18px;color:#1E1520;">...</div>
          <div id="partner-week" style="font-size:12px;color:var(--text-soft);">ì„ì‹  ì£¼ìˆ˜ í™•ì¸ ì¤‘...</div>
        </div>
      </div>
    </div>
    <div id="partner-timeline" style="padding:0 18px 20px;"></div>
  </div>

  <!-- SETTINGS -->

  <div class="screen" id="s-settings">
    
    <div class="screen-hdr">
      <div class="back-btn" onclick="goBack()">â†</div>
      <div class="screen-hdr-title">ì„¤ì •</div>
    </div>
    <div style="padding:20px;">
      <div class="info-block" style="margin-bottom:16px;">
        <div class="block-title">ë‚´ í”„ë¡œí•„</div>
        <div class="info-row">
          <div class="i-lbl">ì„ì‹  ì£¼ìˆ˜</div>
          <input id="week-input" type="number" class="txt-in" style="width:80px;text-align:right;" placeholder="24">
        </div>
        <div class="info-row">
          <div class="i-lbl">ì¶œì‚° ì˜ˆì •ì¼</div>
          <input id="edd-input" type="date" class="txt-in" style="width:160px;text-align:right;">
        </div>
        <div style="padding:12px 16px;">
          <button class="save-btn" onclick="saveProfile()">ì €ì¥</button>
        </div>
      </div>
      <div class="info-block" style="margin-bottom:16px;">
        <div class="block-title">íŒŒíŠ¸ë„ˆ ì´ˆëŒ€</div>
        <div style="padding:16px;">
          <div style="font-size:12px;color:var(--text-soft);margin-bottom:12px;">ì´ˆëŒ€ ë§í¬ë¥¼ íŒŒíŠ¸ë„ˆì—ê²Œ ë³´ë‚´ë©´ ë‚´ ê¸°ë¡ì„ ë³¼ ìˆ˜ ìˆì–´ìš”</div>
          <div id="invite-link" style="background:var(--lilac-pale);border-radius:12px;padding:12px;font-size:12px;color:var(--lilac-deep);word-break:break-all;margin-bottom:10px;">ë§í¬ ìƒì„± ì¤‘...</div>
          <button class="save-btn" onclick="copyInviteLink()">ë§í¬ ë³µì‚¬ ğŸ“‹</button>
        </div>
      </div>
      <button onclick="signOut()" style="width:100%;background:#FAF7FB;color:var(--text-soft);border:1px solid var(--border);border-radius:15px;padding:14px;font-family:'Outfit',sans-serif;font-size:14px;font-weight:600;cursor:pointer;">ë¡œê·¸ì•„ì›ƒ</button>
    </div>
  </div>

  <!-- BOTTOM NAV -->

  <nav class="bottom-nav">
    <div class="nav-item active" id="n-home" onclick="navTo('s-home','n-home')"><i class="ph ph-house"></i></div>
    <div class="nav-item" id="n-cal" onclick="navTo('s-home','n-cal')"><i class="ph ph-calendar"></i></div>
    <div class="fab" onclick="goTo('s-new')"><i class="ph ph-plus"></i></div>
    <div class="nav-item" id="n-med" onclick="navTo('s-medical','n-med')"><i class="ph ph-heart"></i></div>
    <div class="nav-item" id="n-set" onclick="navTo('s-settings','n-set');loadProfile()"><i class="ph ph-gear"></i></div>
  </nav>
</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<script>
  // ===== INIT =====
  const _supabase = supabase.createClient(
    'https://sctgioatjgudhtinvesf.supabase.co',
    'sb_publishable_Fivp1MTaIYVnvTJkQDyvIw_wHrmQ5d-'
  );

  let selectedFile = null;
  let hist = [];

  // ===== NAVIGATION =====
  function goTo(id) {
    const c = document.querySelector('.screen.active');
    const n = document.getElementById(id);
    if (!n || c === n) return;
    if (c) c.classList.add('exit');
    n.classList.add('active');
    hist.push(id);
    setTimeout(() => { if (c) c.classList.remove('active','exit'); }, 340);
  }

  function goBack() {
    if (hist.length <= 1) return;
    hist.pop();
    const prevId = hist[hist.length - 1];
    const c = document.querySelector('.screen.active');
    const p = document.getElementById(prevId);
    if (!p || !c) return;
    p.classList.add('active');
    c.style.transition = 'transform 0.3s cubic-bezier(0.4,0,0.2,1)';
    c.style.transform = 'translateX(100%)';
    setTimeout(() => { c.classList.remove('active'); c.style.cssText = ''; }, 310);
    if (prevId === 's-home') loadEntries();
  }

  function navTo(screenId, navId) {
    document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
    const nav = document.getElementById(navId);
    if (nav) nav.classList.add('active');
    const c = document.querySelector('.screen.active');
    const n = document.getElementById(screenId);
    if (!n) return;
    if (c) c.classList.remove('active');
    n.classList.add('active');
    hist = [screenId];
    if (screenId === 's-home') loadEntries();
    if (screenId === 's-settings') loadProfile();
  }

  function selTab(el) {
    el.closest('.type-tabs').querySelectorAll('.type-tab').forEach(t => t.classList.remove('on'));
    el.classList.add('on');
  }

  function selPill(el) {
    el.closest('.pills').querySelectorAll('.pill').forEach(p => p.classList.remove('on'));
    el.classList.add('on');
  }

  // ===== PHOTO =====
  function previewPhoto(input) {
    const file = input.files?.[0];
    if (!file) return;
    selectedFile = file;
    const reader = new FileReader();
    reader.onload = e => {
      const preview = document.getElementById('photo-preview');
      if (preview) { preview.src = e.target.result; preview.style.display = 'block'; }
      const lbl = document.getElementById('cam-lbl');
      if (lbl) lbl.style.display = 'none';
    };
    reader.readAsDataURL(file);
  }

  async function uploadPhoto() {
    if (!selectedFile) return null;
    const fileName = `${Date.now()}.jpg`;
    const { error } = await _supabase.storage.from('photos').upload(fileName, selectedFile);
    if (error) { console.error(error); return null; }
    const { data } = _supabase.storage.from('photos').getPublicUrl(fileName);
    return data?.publicUrl ?? null;
  }

  // ===== AUTH =====
  async function signIn() {
    const email = document.getElementById('login-email').value.trim();
    const pw = document.getElementById('login-pw').value;
    const { error } = await _supabase.auth.signInWithPassword({ email, password: pw });
    if (error) { alert('ë¡œê·¸ì¸ ì‹¤íŒ¨ ğŸ˜¢ ' + error.message); return; }
    const pending = localStorage.getItem('pendingInvite');
    if (pending) { localStorage.removeItem('pendingInvite'); await loadPartnerFeed(pending); return; }
    document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
    document.getElementById('s-home').classList.add('active');
    hist = ['s-home'];
    loadEntries();
  }

  async function signUp() {
    const email = document.getElementById('login-email').value.trim();
    const pw = document.getElementById('login-pw').value;
    const { error } = await _supabase.auth.signUp({ email, password: pw });
    if (error) { alert('ê°€ì… ì‹¤íŒ¨ ğŸ˜¢ ' + error.message); return; }
    alert('ê°€ì… ì™„ë£Œ! ğŸŒ¸');
    document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
    document.getElementById('s-home').classList.add('active');
    hist = ['s-home'];
    loadEntries();
  }

  async function signOut() {
    await _supabase.auth.signOut();
    document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
    document.getElementById('s-login').classList.add('active');
    hist = ['s-login'];
  }

  async function checkAuth() {
    const params = new URLSearchParams(window.location.search);
    const inviteCode = params.get('invite');
    const { data: { session } } = await _supabase.auth.getSession();

    if (inviteCode) {
      if (!session) {
        localStorage.setItem('pendingInvite', inviteCode);
        document.getElementById('s-login').classList.add('active');
        hist = ['s-login'];
      } else {
        await loadPartnerFeed(inviteCode);
      }
      return;
    }

    document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
    if (session) {
      document.getElementById('s-home').classList.add('active');
      hist = ['s-home'];
      loadEntries();
    } else {
      document.getElementById('s-login').classList.add('active');
      hist = ['s-login'];
    }
  }

  // ===== ENTRIES =====
  function entryHTML(entry, showComments = false) {
  return `
    <div class="tl-date">${entry.date || ''}</div>
    <div class="tl-row">
      <div class="tl-spine">
        <div class="tl-dot ${entry.image_url ? 'gold' : ''}"></div>
        <div class="tl-line"></div>
      </div>
      <div class="card">
        <div class="card-top">
          <div class="card-icon ${entry.image_url ? 'us' : 'diary'}">${entry.image_url ? 'ğŸ”¬' : 'ğŸ“'}</div>
          <div class="card-meta">
            <div class="card-type">${entry.type || 'ì¼ê¸°'}</div>
            <div class="card-time">${entry.created_at ? new Date(entry.created_at).toLocaleTimeString('ko-KR',{hour:'2-digit',minute:'2-digit'}) : ''}</div>
          </div>
          <div class="week-tag">${entry.week ? entry.week+'ì£¼' : ''}</div>
        </div>
        ${entry.image_url ? `<div class="us-photo" style="background-image:url('${entry.image_url}');background-size:cover;background-position:center;"></div>` : ''}
        <div class="card-body">
          <div class="card-text">${entry.content || ''}</div>
          ${entry.mood ? `<div class="mood">${entry.mood}</div>` : ''}
        </div>
        <div class="comments" id="comments-${entry.id}">
          <div class="cmt-loading" style="font-size:11px;color:var(--text-soft);padding:4px 0;">ëŒ“ê¸€ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
        </div>
        <div class="cmt-input-row" style="padding:0 13px 11px;display:flex;gap:7px;align-items:center;">
          <div class="cmt-av" style="background:var(--lilac-pale)">ğŸŒ¸</div>
          <input class="cmt-input" placeholder="ëŒ“ê¸€..." id="cmt-input-${entry.id}">
          <button onclick="addComment(${entry.id})" style="background:var(--lilac-deep);color:white;border:none;border-radius:10px;padding:6px 12px;font-size:11px;cursor:pointer;">ì „ì†¡</button>
        </div>
      </div>
    </div>`;
}


  async function loadEntries() {
    const timeline = document.querySelector('#s-home .timeline');
    if (!timeline) return;
    const { data, error } = await _supabase.from('entries').select('*').order('created_at', { ascending: false });
    if (error) { console.error(error); return; }
    timeline.innerHTML = '';
    (data || []).forEach(entry => {
      const div = document.createElement('div');
      div.innerHTML = entryHTML(entry);
      timeline.appendChild(div);loadComments(entry.id);

    });
  }

  async function saveEntry() {
    const content = document.getElementById('entry-content')?.value ?? '';
    const weekEl = document.querySelector('#week-pills .pill.on');
    const week = weekEl ? parseInt(weekEl.textContent) : null;
    const moodEl = document.querySelector('#mood-pills .pill.on');
    const mood = moodEl?.textContent ?? '';
    const type = document.querySelector('#s-new .type-tab.on')?.textContent?.trim() ?? 'ì¼ê¸°';
    const isPublic = document.getElementById('privacy-public')?.classList.contains('on') ?? false;

    const { data: { user }, error: uerr } = await _supabase.auth.getUser();
    if (uerr || !user) { alert('ë¡œê·¸ì¸ì´ í•„ìš”í•´ìš” ğŸ˜¢'); return; }

    let image_url = null;
    if (selectedFile) image_url = await uploadPhoto();

    const { error } = await _supabase.from('entries').insert({
      type, content, week, mood,
      date: new Date().toISOString().split('T')[0],
      image_url, user_id: user.id, is_public: isPublic
    });

    if (error) { alert('ì €ì¥ ì‹¤íŒ¨ ğŸ˜¢'); console.error(error); return; }

    selectedFile = null;
    const preview = document.getElementById('photo-preview');
    if (preview) { preview.src=''; preview.style.display='none'; }
    const camLbl = document.getElementById('cam-lbl');
    if (camLbl) camLbl.style.display='block';
    document.getElementById('entry-content').value = '';

    alert('ì €ì¥ëì–´! ğŸŒ¸');
    goBack();
  }

async function loadComments(entryId) {
  const { data, error } = await _supabase
    .from('comments')
    .select('*')
    .eq('entry_id', entryId)
    .order('created_at', { ascending: true });

  const container = document.getElementById(`comments-${entryId}`);
  if (!container) return;

  if (error || !data || data.length === 0) {
    container.innerHTML = '';
    return;
  }

  container.innerHTML = data.map(c => `
    <div class="cmt-row">
      <div class="cmt-av">ğŸ’¬</div>
      <div class="cmt-bubble">
        <div class="cmt-name">${c.display_name || 'ìµëª…'}</div>
        <div class="cmt-text">${c.content}</div>
      </div>
    </div>
  `).join('');
}

async function addComment(entryId) {
  const input = document.getElementById(`cmt-input-${entryId}`);
  const content = input?.value?.trim();
  if (!content) return;

  const { data: { user } } = await _supabase.auth.getUser();
  if (!user) { alert('ë¡œê·¸ì¸ì´ í•„ìš”í•´ìš”'); return; }

  const { data: profile } = await _supabase.from('profiles').select('display_name').eq('id', user.id).single();
  const display_name = profile?.display_name || user.email;

  const { error } = await _supabase.from('comments').insert({
    entry_id: entryId,
    user_id: user.id,
    display_name,
    content
  });

  if (error) { console.error(error); return; }
  input.value = '';
  loadComments(entryId);
}



  // ===== PARTNER FEED =====
  async function loadPartnerFeed(inviteCode) {
    const { data: profile } = await _supabase.from('profiles').select('*').eq('invite_code', inviteCode).single();
    if (!profile) { alert('ìœ íš¨í•˜ì§€ ì•Šì€ ì´ˆëŒ€ ë§í¬ì˜ˆìš” ğŸ˜¢'); return; }

    const { data: { user } } = await _supabase.auth.getUser();
    await _supabase.from('follows').upsert({ follower_id: user.id, following_id: profile.id });

    document.getElementById('partner-name').textContent = profile.display_name || 'ì‘ì„±ì';
    document.getElementById('partner-week').textContent = `ì„ì‹  ${profile.current_week || '?'}ì£¼ì°¨ ğŸ¤°`;

    const { data: entries } = await _supabase.from('entries').select('*').eq('user_id', profile.id).eq('is_public', true).order('created_at', { ascending: false });

    const timeline = document.getElementById('partner-timeline');
    timeline.innerHTML = '';
    if (!entries || entries.length === 0) {
      timeline.innerHTML = '<div style="text-align:center;color:var(--text-soft);padding:40px;font-size:13px;">ì•„ì§ ê³µê°œëœ ê¸°ë¡ì´ ì—†ì–´ìš” ğŸŒ±</div>';
    } else {
      entries.forEach(entry => {
        const div = document.createElement('div');
        div.innerHTML = entryHTML(entry);
        timeline.appendChild(div);
      });
    }

    document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
    document.getElementById('s-partner').classList.add('active');
    hist = ['s-partner'];
  }

  // ===== PROFILE / SETTINGS =====
  async function loadProfile() {
  const { data: { user } } = await _supabase.auth.getUser();
  if (!user) return;

  // í”„ë¡œí•„ ì—†ìœ¼ë©´ ë¨¼ì € ìƒì„±
  let { data: profile } = await _supabase.from('profiles').select('*').eq('id', user.id).single();
  
  if (!profile) {
    await _supabase.from('profiles').insert({ id: user.id, display_name: user.email });
    let { data: newProfile } = await _supabase.from('profiles').select('*').eq('id', user.id).single();
    profile = newProfile;
  }

  if (!profile) return;

  let code = profile.invite_code;
  if (!code) {
    code = Math.random().toString(36).slice(2, 10);
    await _supabase.from('profiles').update({ invite_code: code }).eq('id', user.id);
  }

  if (profile.current_week) document.getElementById('week-input').value = profile.current_week;
  if (profile.edd) document.getElementById('edd-input').value = profile.edd;
  document.getElementById('invite-link').textContent = `${window.location.origin}?invite=${code}`;
}

  async function saveProfile() {
    const { data: { user } } = await _supabase.auth.getUser();
    if (!user) return;
    const week = parseInt(document.getElementById('week-input').value);
    const edd = document.getElementById('edd-input').value;
    await _supabase.from('profiles').update({ current_week: week, edd }).eq('id', user.id);
    alert('ì €ì¥ëì–´! ğŸŒ¸');
  }

  async function copyInviteLink() {
    const link = document.getElementById('invite-link').textContent;
    await navigator.clipboard.writeText(link);
    alert('ë§í¬ ë³µì‚¬ëì–´! ğŸ“‹');
  }

  // ===== START =====
  window.addComment = addComment;

  window.addEventListener('DOMContentLoaded', () => { checkAuth(); });
</script>

</body>
</html>